{% extends "base.html" %}
{% block page_panel %}
<div class="panel-header">
    <h2>Cold Storage Temperature Log – Unit Wise (HACCP)</h2>
</div>

<div class="cold-storage-container">
    <!-- Unit Grid at Top -->
    <div class="units-grid-section">
        <div class="units-grid-header">
            <h3>Units</h3>
            <button id="manage-units-btn" class="btn-secondary">Manage Units</button>
            <button id="generate-pdf-btn" class="btn-primary">Generate PDF</button>
        </div>
        <div id="units-grid" class="units-grid">
            <!-- Units will be populated by JavaScript -->
        </div>
    </div>

    <!-- Week View for Each Unit -->
    <div id="units-week-view" class="units-week-view">
        <!-- Each unit's week view will be generated here -->
    </div>

    <!-- Empty State -->
    <div id="empty-state" class="empty-state">
        <p>No units found. Please add units to start logging temperatures.</p>
    </div>
</div>

<!-- Unit Management Modal -->
<div id="unit-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-title">Manage Units</h3>
            <button class="modal-close" id="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div id="unit-list-container">
                <!-- Unit list will be populated here -->
            </div>
            <button id="add-unit-btn" class="btn-primary">Add New Unit</button>
        </div>
    </div>
</div>

<!-- Add/Edit Unit Form Modal -->
<div id="unit-form-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="unit-form-title">Add Unit</h3>
            <button class="modal-close" id="unit-form-close">&times;</button>
        </div>
        <div class="modal-body">
            <form id="unit-form">
                <input type="hidden" id="unit-id" name="unit_id">
                <div class="form-group">
                    <label for="unit-number">Unit Number *</label>
                    <input type="text" id="unit-number" name="unit_number" required>
                </div>
                <div class="form-group">
                    <label for="unit-location">Location *</label>
                    <input type="text" id="unit-location" name="location" required>
                </div>
                <div class="form-group">
                    <label for="unit-type">Unit Type *</label>
                    <select id="unit-type" name="unit_type" required>
                        <option value="">-- Select Type --</option>
                        <option value="Refrigerator">Refrigerator</option>
                        <option value="Freezer">Freezer</option>
                        <option value="Wine Chiller">Wine Chiller</option>
                    </select>
                </div>
                <div class="form-group hidden" id="wine-chiller-temps">
                    <label for="min-temp">Minimum Temperature (°C)</label>
                    <input type="number" id="min-temp" name="min_temp" step="0.1">
                    <label for="max-temp">Maximum Temperature (°C)</label>
                    <input type="number" id="max-temp" name="max_temp" step="0.1">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Save</button>
                    <button type="button" class="btn-secondary" id="cancel-unit-form">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- PDF Generation Modal -->
<div id="pdf-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Generate PDF Report</h3>
            <button class="modal-close" id="pdf-modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <form id="pdf-form">
                <div class="form-group">
                    <label>Report Type:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="report_type" value="daily" checked> Single Date</label>
                        <label><input type="radio" name="report_type" value="weekly"> Week Range</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="pdf-start-date">Start Date *</label>
                    <input type="date" id="pdf-start-date" name="start_date" required>
                </div>
                <div class="form-group hidden" id="pdf-end-date-group">
                    <label for="pdf-end-date">End Date *</label>
                    <input type="date" id="pdf-end-date" name="end_date">
                </div>
                <div class="form-group">
                    <label>Select Units:</label>
                    <div id="pdf-unit-checkboxes">
                        <!-- Checkboxes will be populated by JavaScript -->
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Generate PDF</button>
                    <button type="button" class="btn-secondary" id="cancel-pdf">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='cold_storage_temperature_log.js') }}"></script>
{% endblock %}
