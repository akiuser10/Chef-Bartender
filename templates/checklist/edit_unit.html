{% extends "base.html" %}
{% block page_panel %}
<div class="panel-header">
    <h2>Edit Cold Storage Unit</h2>
</div>

<div class="page-panel">
    <div class="section-container">
        <form method="POST" class="form-container">
            <div class="form-group">
                <label for="unit_number">Unit Number / Name *</label>
                <input type="text" id="unit_number" name="unit_number" class="form-input" required value="{{ unit.unit_number }}">
                <small style="color: #666;">Unique identifier for this unit</small>
            </div>

            <div class="form-group">
                <label for="unit_name">Descriptive Name (Optional)</label>
                <input type="text" id="unit_name" name="unit_name" class="form-input" value="{{ unit.unit_name or '' }}">
            </div>

            <div class="form-group">
                <label for="unit_type">Unit Type *</label>
                <select id="unit_type" name="unit_type" class="form-input" required onchange="updateTempRange()">
                    <option value="">Select Type</option>
                    <option value="Freezer" {% if unit.unit_type == 'Freezer' %}selected{% endif %}>Freezer (-22°C to -12°C)</option>
                    <option value="Refrigerator" {% if unit.unit_type == 'Refrigerator' %}selected{% endif %}>Refrigerator (0°C to 4°C)</option>
                    <option value="Wine Chiller" {% if unit.unit_type == 'Wine Chiller' %}selected{% endif %}>Wine Chiller (User-defined)</option>
                </select>
            </div>

            <div id="wine_chiller_range" style="display: {% if unit.unit_type == 'Wine Chiller' %}block{% else %}none{% endif %};">
                <div class="form-group">
                    <label for="min_temp">Minimum Temperature (°C)</label>
                    <input type="number" id="min_temp" name="min_temp" class="form-input" step="0.1" value="{{ unit.min_temp or '' }}" placeholder="e.g., 8">
                </div>

                <div class="form-group">
                    <label for="max_temp">Maximum Temperature (°C)</label>
                    <input type="number" id="max_temp" name="max_temp" class="form-input" step="0.1" value="{{ unit.max_temp or '' }}" placeholder="e.g., 12">
                </div>
            </div>

            <div id="temp_range_info" style="background: #f0f8ff; padding: 15px; border-radius: 6px; margin-bottom: 20px; display: {% if unit.unit_type != 'Wine Chiller' %}block{% else %}none{% endif %};">
                <strong>Temperature Range:</strong> <span id="range_text">
                    {% if unit.unit_type == 'Freezer' %}-22°C to -12°C{% elif unit.unit_type == 'Refrigerator' %}0°C to 4°C{% endif %}
                </span>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Update Unit</button>
                <a href="{{ url_for('checklist.manage_units') }}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
function updateTempRange() {
    const unitType = document.getElementById('unit_type').value;
    const wineChillerDiv = document.getElementById('wine_chiller_range');
    const infoDiv = document.getElementById('temp_range_info');
    const rangeText = document.getElementById('range_text');
    
    if (unitType === 'Wine Chiller') {
        wineChillerDiv.style.display = 'block';
        infoDiv.style.display = 'none';
    } else {
        wineChillerDiv.style.display = 'none';
        if (unitType === 'Freezer') {
            rangeText.textContent = '-22°C to -12°C';
            infoDiv.style.display = 'block';
        } else if (unitType === 'Refrigerator') {
            rangeText.textContent = '0°C to 4°C';
            infoDiv.style.display = 'block';
        } else {
            infoDiv.style.display = 'none';
        }
    }
}
</script>
{% endblock %}

