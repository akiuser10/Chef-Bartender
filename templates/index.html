{% extends "base.html" %}
{% block page_panel %}
<!-- Hero Section with Slider -->
<div class="hero-section-foodility">
    <div class="hero-slider-container">
        {% if hero_slides %}
            {% for slide in hero_slides %}
                {% if slide.is_active and slide.image_path %}
                <div class="hero-slide-foodility {% if loop.first %}active{% endif %}" data-slide="{{ slide.slide_number }}">
                    <div class="hero-slide-bg" data-bg-image="{{ url_for('main.uploaded_file', filename=slide.image_path.replace('uploads/', '', 1)) }}"></div>
                    <div class="hero-content-foodility">
                        <div class="hero-text-container">
                            <h1 class="hero-title-script">{{ slide.title }}</h1>
                            {% if slide.subtitle %}
                            <p class="hero-subtitle">{{ slide.subtitle }}</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endif %}
            {% endfor %}
        {% else %}
            <!-- Fallback slides if no database slides exist -->
            <div class="hero-slide-foodility active" data-slide="0">
                <div class="hero-slide-bg" data-bg-image="{{ url_for('static', filename='images/hero/green-smoothie.jpg') }}"></div>
                <div class="hero-content-foodility">
                    <div class="hero-text-container">
                        <h1 class="hero-title-script">Healthy Smoothie</h1>
                        <p class="hero-subtitle">Fresh ingredients, natural flavors, perfect blend</p>
                    </div>
                </div>
            </div>
        {% endif %}
        
        <!-- Navigation Arrows -->
        <button class="carousel-nav-foodility carousel-prev-foodility" aria-label="Previous" id="heroPrevBtnFoodility">‹</button>
        <button class="carousel-nav-foodility carousel-next-foodility" aria-label="Next" id="heroNextBtnFoodility">›</button>
    </div>
    
    <!-- Static Product Showcase Below Hero -->
    <div class="hero-products-showcase">
        <div class="product-bottle red-juice"></div>
        <div class="product-bottle orange-juice"></div>
        <div class="product-bottle beige-juice"></div>
        <div class="product-fruits-decoration"></div>
    </div>
</div>

<!-- Recipe Section -->
<section class="beverage-section">
    <div class="section-container">
        <h2 class="section-title">Recipe</h2>
        <div class="beverage-grid">
            {% if recent_recipes %}
                {% for recipe in recent_recipes %}
                <a href="{% if recipe.recipe_code %}{{ url_for('recipes.view_recipe_by_code', code=recipe.recipe_code) }}{% else %}{{ url_for('recipes.view_recipe', id=recipe.id) }}{% endif %}" class="beverage-card recipe-card recipe-card-link">
                    {% if recipe.image_path %}
                        <div class="beverage-image recipe-image recipe-image-with-url" data-image-url="{{ url_for('main.uploaded_file', filename=recipe.image_path) }}"></div>
                    {% else %}
                        {% set color_index = loop.index0 % 8 %}
                        <div class="beverage-image recipe-image recipe-color-{{ color_index }}"></div>
                    {% endif %}
                    <h3 class="beverage-name">{{ recipe.title }}</h3>
                </a>
                {% endfor %}
            {% else %}
                <!-- Placeholder cards when no recipes exist -->
                {% for i in range(8) %}
                <div class="beverage-card recipe-card">
                    <div class="beverage-image recipe-image recipe-color-{{ i }}"></div>
                    <h3 class="beverage-name">No Recipes Yet</h3>
                </div>
                {% endfor %}
            {% endif %}
        </div>
        <button class="carousel-nav-foodility beverage-prev">‹</button>
        <button class="carousel-nav-foodility beverage-next">›</button>
    </div>
</section>

<!-- Big Deals Section -->
<section class="big-deals-section">
    <div class="section-container">
        <div class="big-deals-circle">
            <div class="deals-bg-pattern"></div>
            <h2 class="deals-title">Big Deals of the Week</h2>
            <p class="deals-subtitle">Special offers on your favorite beverages</p>
        </div>
    </div>
</section>

<!-- Detox Smoothie Recipe Section -->
<section class="recipe-section">
    <div class="section-container">
        <h2 class="section-title">Detox Smoothie Recipe</h2>
        <div class="recipe-content">
            <div class="recipe-ingredients">
                <div class="ingredient-item">
                    <div class="ingredient-icon cucumber"></div>
                    <div class="ingredient-text">
                        <h4>Cucumber</h4>
                        <p>Fresh and hydrating</p>
                    </div>
                </div>
                <div class="ingredient-item">
                    <div class="ingredient-icon apple"></div>
                    <div class="ingredient-text">
                        <h4>Apple</h4>
                        <p>Natural sweetness</p>
                    </div>
                </div>
                <div class="ingredient-item">
                    <div class="ingredient-icon lemon"></div>
                    <div class="ingredient-text">
                        <h4>Lemon</h4>
                        <p>Vitamin C boost</p>
                    </div>
                </div>
                <div class="ingredient-item">
                    <div class="ingredient-icon water"></div>
                    <div class="ingredient-text">
                        <h4>Fresh Water</h4>
                        <p>Pure hydration</p>
                    </div>
                </div>
            </div>
            <div class="recipe-bottle">
                <div class="bottle-image"></div>
            </div>
        </div>
    </div>
</section>

<!-- Upcoming Beverage Section -->
<section class="upcoming-section">
    <div class="section-container">
        <h2 class="section-title">Upcoming Our Beverage</h2>
        <div class="upcoming-content">
            <div class="upcoming-text">
                <p>Discover our latest creations and seasonal specials. We're constantly innovating to bring you the freshest, most delicious beverages.</p>
                <p>Stay tuned for exciting new flavors and limited-time offers that celebrate the best of each season.</p>
            </div>
            <div class="upcoming-image">
                <div class="outdoor-drinks-image"></div>
            </div>
        </div>
    </div>
</section>

<!-- Knowledge Hub Section -->
<section class="blog-section knowledge-hub-section">
    <div class="section-container">
        <h2 class="section-title">Knowledge Hub</h2>
        <div class="blog-grid knowledge-hub-grid">
            {% if recent_books %}
                {% for book in recent_books %}
                <div class="blog-card knowledge-hub-card">
                    {% if book.cover_image_path %}
                        {% set cover_path = book.cover_image_path.replace('uploads/', '', 1) if book.cover_image_path.startswith('uploads/') else book.cover_image_path %}
                        <div class="blog-image knowledge-hub-image" data-cover-image="{{ url_for('main.uploaded_file', filename=cover_path) }}"></div>
                    {% else %}
                        <div class="blog-image knowledge-hub-image knowledge-hub-placeholder"></div>
                    {% endif %}
                    <h3 class="blog-title knowledge-hub-title">{{ book.title }}</h3>
                </div>
                {% endfor %}
            {% else %}
                <!-- Placeholder cards when no books exist -->
                {% for i in range(3) %}
                <div class="blog-card knowledge-hub-card">
                    <div class="blog-image knowledge-hub-image knowledge-hub-placeholder"></div>
                    <h3 class="blog-title knowledge-hub-title">No Books Yet</h3>
                </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>
</section>

<!-- Gallery Section -->
<section class="gallery-section">
    <div class="section-container">
        <div class="gallery-carousel">
            <div class="gallery-item gallery-1"></div>
            <div class="gallery-item gallery-2"></div>
            <div class="gallery-item gallery-3"></div>
            <div class="gallery-item gallery-4"></div>
            <div class="gallery-item gallery-5"></div>
            <div class="gallery-item gallery-6"></div>
        </div>
        <button class="carousel-nav-foodility gallery-prev">‹</button>
        <button class="carousel-nav-foodility gallery-next">›</button>
</div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Hero Slider
    const heroSlides = document.querySelectorAll('.hero-slide-foodility');
    const heroPrevBtn = document.getElementById('heroPrevBtnFoodility');
    const heroNextBtn = document.getElementById('heroNextBtnFoodility');
    let currentHeroSlide = 0;
    let heroAutoSlideInterval;
    
    function showHeroSlide(index) {
        heroSlides.forEach(slide => slide.classList.remove('active'));
        if (heroSlides[index]) {
            heroSlides[index].classList.add('active');
        }
    }
    
    function nextHeroSlide() {
        currentHeroSlide = (currentHeroSlide + 1) % heroSlides.length;
        showHeroSlide(currentHeroSlide);
        resetHeroAutoSlide();
    }
    
    function prevHeroSlide() {
        currentHeroSlide = (currentHeroSlide - 1 + heroSlides.length) % heroSlides.length;
        showHeroSlide(currentHeroSlide);
        resetHeroAutoSlide();
    }
    
    function startHeroAutoSlide() {
        if (heroAutoSlideInterval) {
            clearInterval(heroAutoSlideInterval);
        }
        heroAutoSlideInterval = setInterval(nextHeroSlide, 5000);
    }
    
    function resetHeroAutoSlide() {
        startHeroAutoSlide();
    }
    
    if (heroNextBtn) heroNextBtn.addEventListener('click', nextHeroSlide);
    if (heroPrevBtn) heroPrevBtn.addEventListener('click', prevHeroSlide);
    
    startHeroAutoSlide();
    
    // Set background images for recipe cards with images
    document.querySelectorAll('.recipe-image-with-url').forEach(function(img) {
        const imageUrl = img.getAttribute('data-image-url');
        if (imageUrl) {
            img.style.backgroundImage = 'url(' + imageUrl + ')';
        }
    });
    
    // Set background images for hero slides
    document.querySelectorAll('.hero-slide-bg').forEach(function(bg) {
        const imageUrl = bg.getAttribute('data-bg-image');
        if (imageUrl) {
            bg.style.backgroundImage = 'url(' + imageUrl + ')';
        }
    });
    
    // Set background images for knowledge hub book covers
    document.querySelectorAll('.knowledge-hub-image[data-cover-image]').forEach(function(img) {
        const imageUrl = img.getAttribute('data-cover-image');
        if (imageUrl) {
            img.style.backgroundImage = 'url(' + imageUrl + ')';
            img.style.backgroundSize = 'cover';
            img.style.backgroundPosition = 'center';
        }
    });
});
</script>
{% endblock %}
